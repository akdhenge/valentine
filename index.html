<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Will you be my Valentine?</title>

  <style>
    :root{
      --bg1:#ffebf3; --bg2:#ffe6cc;
      --card:rgba(255,255,255,.78);
      --text:#1f1f1f;
      --shadow:0 18px 50px rgba(0,0,0,.12);
      --radius:24px; --pill:999px;
      --pink1:#ff4d8d; --pink2:#ff2d55;
      --dark:#111;
    }
    *{box-sizing:border-box}
    body{
      margin:0; min-height:100vh;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
      color:var(--text);
      overflow:hidden;
      background:
        radial-gradient(1200px 800px at 20% 20%, #fff 0%, transparent 60%),
        radial-gradient(900px 700px at 80% 30%, #fff 0%, transparent 55%),
        linear-gradient(135deg,var(--bg1),var(--bg2));
    }

    /* Floating emojis */
    .hearts{position:fixed; inset:0; pointer-events:none; opacity:.45; z-index:0;}
    .heart{
      position:absolute; transform:translateY(110vh);
      animation:floaty linear infinite;
      will-change:transform,opacity; user-select:none;
    }
    @keyframes floaty{
      0%{transform:translateY(110vh) translateX(0) rotate(0deg); opacity:0}
      10%{opacity:1}
      100%{transform:translateY(-20vh) translateX(var(--drift)) rotate(var(--rot)); opacity:0}
    }

    .wrap{position:relative; z-index:1; min-height:100vh; display:grid; place-items:center; padding:18px;}
    .card{
      width:min(760px,92vw);
      background:var(--card);
      border:1px solid rgba(255,255,255,.55);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:26px 22px 20px;
      text-align:center;
      backdrop-filter:blur(10px);
      -webkit-backdrop-filter:blur(10px);
    }
    h1{margin:0 0 8px; font-size:clamp(28px,5vw,44px); letter-spacing:-.02em;}
    .sub{margin:0 auto 14px; max-width:60ch; font-size:16px; opacity:.9; line-height:1.4;}
    .badge{
      display:inline-block;
      padding:8px 12px;
      border-radius:999px;
      background:rgba(255,59,122,.12);
      border:1px solid rgba(255,59,122,.22);
      font-weight:650;
      font-size:13px;
      margin-bottom:12px;
    }

    .playground{
      position:relative;
      height:300px;
      margin-top:6px;
      border-radius:18px;
      background:rgba(255,255,255,.6);
      border:1px dashed rgba(0,0,0,.14);
      overflow:hidden;
    }

    button{
      appearance:none; border:none; cursor:pointer;
      padding:14px 22px;
      border-radius:var(--pill);
      font-size:18px;
      font-weight:750;
      box-shadow:0 10px 22px rgba(0,0,0,.12);
      transition:transform .18s ease, filter .12s ease, box-shadow .2s ease, opacity .25s ease;
      user-select:none; -webkit-tap-highlight-color:transparent;
    }
    button:hover{filter:brightness(1.02)}
    button:active{transform:scale(.98)}

    #yesBtn{
      position:absolute;
      left:60%;
      top:46%;
      background:linear-gradient(135deg,var(--pink1),var(--pink2));
      color:#fff;
      transition: all .15s ease;
      z-index:1;
    }
    #noBtn{
      position:absolute;
      left:30%;
      top:55%;
      background:var(--dark);
      color:#fff;
      transform-origin:center;
      transition:transform .3s cubic-bezier(.34,1.56,.64,1), box-shadow .25s ease, left .35s ease, top .35s ease, font-size .3s ease, padding .3s ease;
      z-index:2;
    }
    #noBtn:hover{box-shadow:0 0 0 6px rgba(0,0,0,.08)}

    /* tiny third option */
    #forgotBtn{
      position:absolute;
      left:50%;
      bottom:14px;
      transform:translateX(-50%);
      background:transparent;
      box-shadow:none;
      padding:6px 10px;
      font-size:12px;
      font-weight:650;
      color:rgba(0,0,0,.55);
      text-decoration:underline;
      text-underline-offset:3px;
      z-index:3;
    }
    #forgotBtn:hover{color:rgba(0,0,0,.78); filter:none}
    #forgotBtn:active{transform:translateX(-50%) scale(.98)}

    .hint{
      margin-top:8px;
      font-size:13px; opacity:.65; pointer-events:none;
      transition: opacity .3s;
    }

    /* Modals (base) */
    .modal{
      position:fixed; inset:0;
      display:none; place-items:center;
      background:rgba(0,0,0,.55);
      z-index:10;
      padding:18px;
    }
    .modal.show{display:grid}
    .modalCard{
      width:min(720px,92vw);
      background:rgba(255,255,255,.95);
      border-radius:22px;
      box-shadow:0 20px 60px rgba(0,0,0,.25);
      padding:22px;
      text-align:center;
      position:relative;
      overflow:hidden;
    }
    .modalCard h2{margin:6px 0 10px; font-size:clamp(22px,4vw,34px)}
    .catMeme{
      width:360px; max-width:100%;
      border-radius:14px;
      margin:12px auto;
      display:block;
      box-shadow:0 12px 30px rgba(0,0,0,.25);
    }
    .actions{display:flex; justify-content:center; gap:10px; flex-wrap:wrap; margin-top:12px}
    .softBtn{background:#f2f2f2; color:#111; box-shadow:none; border:1px solid rgba(0,0,0,.08)}
    .primaryBtn{background:linear-gradient(135deg,var(--pink1),var(--pink2)); color:#fff}

    /* Chocolate power-up button */
    .chocoWrap{display:grid; place-items:center; margin:10px auto 0; gap:10px}
    .chocoBtn{
      position:relative;
      padding:14px 18px;
      border-radius:18px;
      background:linear-gradient(135deg,#5b2b1f,#2a130c);
      color:#fff;
      box-shadow:0 16px 40px rgba(0,0,0,.22);
      border:1px solid rgba(255,255,255,.12);
      font-size:16px;
      font-weight:800;
      letter-spacing:.01em;
    }
    .chocoBtn::before{
      content:"üç´";
      position:absolute;
      left:12px;
      top:50%;
      transform:translateY(-50%);
      font-size:20px;
      opacity:.95;
    }
    .chocoBtn span{padding-left:26px; display:inline-block}
    .sparkle{font-size:13px; opacity:.8;}
    .coupon{
      display:inline-flex;
      gap:8px;
      align-items:center;
      padding:10px 12px;
      border-radius:16px;
      background:rgba(255,77,141,.12);
      border:1px dashed rgba(255,77,141,.45);
      font-weight:700;
      margin-top:6px;
    }

    /* Power overlay (transformation scene) */
    .powerOverlay{
      position:fixed; inset:0;
      display:none;
      z-index:20;
      background:
        radial-gradient(900px 600px at 50% 30%, rgba(255,255,255,.55), transparent 60%),
        linear-gradient(135deg, rgba(255,77,141,.65), rgba(255,45,85,.65));
      backdrop-filter: blur(6px);
      -webkit-backdrop-filter: blur(6px);
      place-items:center;
      padding:18px;
    }
    .powerOverlay.show{display:grid}
    .powerCard{
      width:min(760px,92vw);
      background:rgba(255,255,255,.9);
      border-radius:24px;
      padding:18px;
      box-shadow:0 20px 60px rgba(0,0,0,.25);
      text-align:center;
      position:relative;
      overflow:hidden;
    }
    .powerTitle{
      font-size:clamp(20px,3.4vw,30px);
      margin:6px 0 6px;
      font-weight:900;
      letter-spacing:-.02em;
    }
    .powerSub{margin:0 0 10px; opacity:.85}
    .aura{
      position:absolute; inset:-40px;
      background:
        radial-gradient(circle at 30% 30%, rgba(255,77,141,.35), transparent 55%),
        radial-gradient(circle at 70% 40%, rgba(255,45,85,.35), transparent 55%),
        radial-gradient(circle at 50% 80%, rgba(255,230,204,.55), transparent 60%);
      animation:auraSpin 2.2s linear infinite;
      opacity:.75;
      pointer-events:none;
    }
    @keyframes auraSpin{
      0%{transform:rotate(0deg) scale(1)}
      50%{transform:rotate(180deg) scale(1.05)}
      100%{transform:rotate(360deg) scale(1)}
    }
    .powerGif{
      width:min(520px,100%);
      border-radius:18px;
      box-shadow:0 14px 40px rgba(0,0,0,.22);
      display:block;
      margin:10px auto 12px;
    }
    .countdown{
      font-weight:800;
      background:rgba(0,0,0,.06);
      padding:10px 12px;
      border-radius:14px;
      display:inline-block;
    }

    /* Powered-up state styles */
    .powered #yesBtn{
      transition: transform .35s ease, left .35s ease, top .35s ease, box-shadow .35s ease;
      box-shadow:0 18px 50px rgba(255,45,85,.35);
    }

    /* "Agreement" modal (Option 1: modal summary) */
    .termsCard{
      text-align:left;
      padding:20px;
    }
    .termsTop{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:10px;
      margin-bottom:10px;
    }
    .termsTitle{
      margin:0;
      font-size:clamp(18px,3.2vw,26px);
      font-weight:900;
      letter-spacing:-.02em;
    }
    .termsSmall{
      margin:2px 0 0;
      opacity:.78;
      font-size:13px;
    }
    .termsBox{
      background:rgba(0,0,0,.04);
      border:1px solid rgba(0,0,0,.08);
      border-radius:16px;
      padding:14px;
      max-height:240px;
      overflow:auto;
      line-height:1.35;
    }
    .termsBox ul{
      margin:10px 0 0;
      padding-left:18px;
    }
    .termsBox li{ margin:8px 0; }
    .checkRow{
      display:flex;
      gap:10px;
      align-items:flex-start;
      margin-top:12px;
      background:rgba(255,77,141,.10);
      border:1px solid rgba(255,77,141,.22);
      border-radius:16px;
      padding:12px;
    }
    .checkRow input{ margin-top:3px; transform:scale(1.1); }
    .finePrint{
      margin:8px 0 0;
      font-size:12px;
      opacity:.72;
    }
    .agreeBtn[disabled]{
      opacity:.45;
      cursor:not-allowed;
      filter:none;
    }
    .confetti{
      position:absolute;
      inset:0;
      pointer-events:none;
      overflow:hidden;
    }
    .confetti span{
      position:absolute;
      top:-20px;
      font-size:18px;
      animation: confettiFall linear forwards;
      opacity:.95;
    }
    @keyframes confettiFall{
      0%{transform:translateY(-30px) rotate(0deg); opacity:0}
      15%{opacity:1}
      100%{transform:translateY(520px) rotate(var(--spin)); opacity:0}
    }
  </style>
</head>

<body>
  <div class="hearts" id="hearts"></div>

  <div class="wrap">
    <div class="card" id="cardRoot">
      <div style="font-size:42px; user-select:none; margin-bottom:6px;">üíò</div>
      <h1>Will you be my Valentine?</h1>
      <p class="sub">
        This is a very serious, very scientific compatibility test.
        Please choose wisely. (The universe is watching.)
      </p>
      <div class="badge" id="statusBadge">Status: awaiting your decision‚Ä¶</div>

      <div class="playground" id="arena">
        <button id="yesBtn" aria-label="Yes">YES üíñ</button>
        <button id="noBtn" aria-label="No">NO üôÉ</button>
        <button id="forgotBtn" aria-label="Too hard? Giving up already?">Too hard?? Giving up already?? üè≥Ô∏è</button>
      </div>
      <div class="hint" id="hintText">Tip: the "YES" button is shy. Like‚Ä¶ <i>criminally</i> shy.</div>
    </div>
  </div>

  <!-- NO modal -->
  <div class="modal" id="modalNo">
    <div class="modalCard">
      <div style="font-size:40px" id="noEmoji">üö®</div>
      <h2>HOW DARE YOU</h2>
      <img class="catMeme"
        src="https://media1.giphy.com/media/v1.Y2lkPTc5MGI3NjExZjcwcDR2cWllMWc4dm9wOWY1ajVlMm9zbWR6aGplMWg3NG51amdpbCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/jivGITd768psP80B2i/giphy.gif"
        alt="Jerry meme gif" />
      <p style="margin:0; opacity:.92;">Excuse me?? In this economy?? On this day??</p>
      <p style="margin:6px 0 0; opacity:.82;">Your "NO" has been forwarded to the Department of Romance.</p>
      <div class="actions">
        <button class="softBtn" id="closeNo">Ok ok üôà</button>
        <button class="primaryBtn" id="retryNo">I reconsider üíò</button>
      </div>
    </div>
  </div>

  <!-- "I don't deserve you" modal with chocolate power-up -->
  <div class="modal" id="modalForgot">
    <div class="modalCard">
      <div style="font-size:40px">ü•∫</div>
      <h2>Wow. That's‚Ä¶ accurate.</h2>
      <p style="margin:0; opacity:.9;">
        You selected: <b>"I don't deserve you."</b>
      </p>
      <p style="margin:8px 0 0; opacity:.85;">
        Correct. But I'm trying my best. Please accept this shiny chocolate power-up:
      </p>

      <div class="coupon">
        <span>üéüÔ∏è</span>
        <span>COUPON: <b>SHINY_CHOCOLATE</b></span>
        <span>üç´</span>
      </div>

      <div class="chocoWrap">
        <button class="chocoBtn" id="chocoBtn" aria-label="Take chocolate power-up">
          <span>Take the shiny chocolate</span>
        </button>
        <div class="sparkle">Warning: may cause extreme confidence and sudden YES-clicking ability ‚ú®</div>
      </div>

      <div class="actions">
        <button class="softBtn" id="closeForgot">Close (I'm blushing) üôà</button>
      </div>
    </div>
  </div>

  <!-- Transformation overlay -->
  <div class="powerOverlay" id="powerOverlay" aria-hidden="true">
    <div class="powerCard">
      <div class="aura"></div>
      <div class="powerTitle">üç´ POWER-UP ACTIVATED</div>
      <p class="powerSub">Sugar rush + confidence upgrade detected. Reality is adjusting‚Ä¶</p>
      <img class="powerGif"
        src="https://tenor.com/obbrAF0c3T1.gif"
        alt="Power up gif" />
      <div class="countdown" id="powerCountdown">Rewriting the universe in: 3‚Ä¶</div>
    </div>
  </div>

  <!-- Agreement / Summary modal (Option 1) -->
  <div class="modal" id="modalTerms">
    <div class="modalCard termsCard">
      <div class="confetti" id="confetti"></div>

      <div class="termsTop">
        <div>
          <h2 class="termsTitle">Almost done! Quick Valentine Setup üòá</h2>
          <p class="termsSmall">Just a few tiny, totally normal, definitely-not-suspicious agreements.</p>
        </div>
        <div style="font-size:34px; user-select:none;">üìùüíò</div>
      </div>

      <div class="termsBox">
        <p style="margin:0 0 8px;"><b>Valentine Agreement v1.0</b> (highly official)</p>
        <ul>
          <li>üéÆ I am allowed <b>2 hours of video games</b> per day (non-transferable, but renewable).</li>
          <li>üçΩÔ∏è Dishwasher complaints are now <b>deprecated</b>. Any related tickets are auto-closed.</li>
          <li>üçï Pizza counts as a vegetable on weekends. (Science has spoken.)</li>
          <li>üõå Naps are a basic human right. Interruptions require written approval in triplicate.</li>
          <li>‚òï I get one "coffee first, questions later" card each morning.</li>
          <li>üíñ Unlimited hugs are mandatory. (Yes, this clause is enforceable.)</li>
          <li>üß† If I say "one more game", it means <b>exactly</b> one more game. (No further investigation.)</li>
          <li>üì∫ If we watch a show together, skipping intros requires unanimous consent.</li>
          <li>üß∫ I will do laundry‚Ä¶ eventually. (Timeline to be determined by vibes.)</li>
        </ul>
        <p style="margin:10px 0 0; opacity:.8;">
          By agreeing, you confirm you are: adorable, powerful, and dangerously charming.
        </p>
      </div>

      <div class="checkRow">
        <input type="checkbox" id="termsCheck" />
        <div>
          <div style="font-weight:800;">I have totally read all of this and I definitely agree.</div>
          <div style="font-size:12px; opacity:.75;">(It's okay, nobody reads terms. That's how they get you.)</div>
        </div>
      </div>

      <div class="actions">
        <button class="softBtn" id="termsBack">Wait, what? Go back</button>
        <button class="primaryBtn agreeBtn" id="termsAgree" disabled>Agree & Continue ‚úÖ</button>
      </div>

      <div class="finePrint">
        Fine print: This is a joke. Real agreement includes love, respect, teamwork, and snacks.
      </div>
    </div>
  </div>

  <!-- Final modal -->
  <div class="modal" id="modalFinal">
    <div class="modalCard">
      <div style="font-size:42px">üéâüíò</div>
      <h2>Congratulations!</h2>
      <p style="margin:8px 0 0; opacity:.88;">
        You are officially my Valentine. Also, you just signed <b>Valentine Agreement v1.0</b>.
      </p>
      <p style="margin:10px 0 0; opacity:.8;">
        (Don't worry. The only enforceable clause is: <b>unlimited hugs</b>.)
      </p>
      <div class="actions">
        <button class="primaryBtn" id="finalClose">Okay fine ‚ù§Ô∏è</button>
      </div>
    </div>
  </div>

<script>
  // Floating emojis background
  const heartsEl = document.getElementById('hearts');
  const heartChars = ["üíñ","üíò","üíï","üíó","üíì","üíù","‚ù§Ô∏è","üíû","‚ú®","ü•∞"];
  function makeHeart(){
    const s = document.createElement('div');
    s.className='heart';
    s.textContent = heartChars[Math.floor(Math.random()*heartChars.length)];
    const left = Math.random()*100;
    const dur = 6 + Math.random()*6;
    const drift = (Math.random()*140-70).toFixed(0)+'px';
    const rot = (Math.random()*220-110).toFixed(0)+'deg';
    const size = 16 + Math.random()*20;
    s.style.left = left+'vw';
    s.style.animationDuration = dur+'s';
    s.style.setProperty('--drift', drift);
    s.style.setProperty('--rot', rot);
    s.style.fontSize = size+'px';
    heartsEl.appendChild(s);
    setTimeout(()=>s.remove(), dur*1000);
  }
  for(let i=0;i<18;i++) setTimeout(makeHeart, i*200);
  setInterval(makeHeart, 420);

  // Elements
  const arena = document.getElementById('arena');
  const yesBtn = document.getElementById('yesBtn');
  const noBtn = document.getElementById('noBtn');
  const forgotBtn = document.getElementById('forgotBtn');
  const badge = document.getElementById('statusBadge');
  const hintText = document.getElementById('hintText');
  const cardRoot = document.getElementById('cardRoot');

  const modalNo = document.getElementById('modalNo');
  const closeNo = document.getElementById('closeNo');
  const retryNo = document.getElementById('retryNo');

  const modalForgot = document.getElementById('modalForgot');
  const closeForgot = document.getElementById('closeForgot');
  const chocoBtn = document.getElementById('chocoBtn');

  const powerOverlay = document.getElementById('powerOverlay');
  const powerCountdown = document.getElementById('powerCountdown');

  const modalTerms = document.getElementById('modalTerms');
  const termsCheck = document.getElementById('termsCheck');
  const termsAgree = document.getElementById('termsAgree');
  const termsBack = document.getElementById('termsBack');

  const modalFinal = document.getElementById('modalFinal');
  const finalClose = document.getElementById('finalClose');

  const confetti = document.getElementById('confetti');

  // State
  let poweredUp = false;

  // NO grows when YES escapes (only before power-up)
  let noScale = 1;
  const NO_SCALE_STEP = 0.08;
  const NO_SCALE_MAX  = 1.9;

  function placeYesRandomly(){
    const a = arena.getBoundingClientRect();
    const b = yesBtn.getBoundingClientRect();
    const margin = 12;

    const maxX = Math.max(margin, a.width - b.width - margin);
    const maxY = Math.max(margin, a.height - b.height - margin);

    // keep YES away from the bottom hint + forgot link area
    const bottomReserve = 68;

    const x = margin + Math.random() * (maxX - margin);
    const y = margin + Math.random() * (Math.max(margin, maxY - bottomReserve) - margin);

    yesBtn.style.left = x + 'px';
    yesBtn.style.top  = y + 'px';
  }

  function encourageNo(){
    if (poweredUp) return;
    if (noScale < NO_SCALE_MAX){
      noScale = Math.min(noScale + NO_SCALE_STEP, NO_SCALE_MAX);
      noBtn.style.transform = `scale(${noScale})`;
    }
    if (noScale > 1.2) noBtn.textContent = "NO üòè";
    if (noScale > 1.5) noBtn.textContent = "NO (just saying)";
    if (noScale > 1.75) noBtn.textContent = "NO (it's huge now)";
  }

  function yesEscapes(){
    if (poweredUp) return; // once powered up, YES stops running
    placeYesRandomly();
    encourageNo();
    badge.textContent = "Status: YES button is currently in flight üèÉ‚Äç‚ôÄÔ∏èüí® (NO is gaining confidence‚Ä¶)";
  }

  function fleeFromPointer(clientX, clientY){
    if (poweredUp) return;

    const a = arena.getBoundingClientRect();
    const b = yesBtn.getBoundingClientRect();

    const px = clientX - a.left;
    const py = clientX - a.left ? (clientY - a.top) : (clientY - a.top);

    const bx = (b.left - a.left) + b.width / 2;
    const by = (b.top  - a.top)  + b.height / 2;

    const dist = Math.hypot(px - bx, py - by);
    if (dist < 120) yesEscapes();
  }

  // Mouse + touch
  arena.addEventListener('mousemove', (e)=>fleeFromPointer(e.clientX, e.clientY), {passive:true});
  arena.addEventListener('touchstart', (e)=>{ const t=e.touches[0]; if(t) fleeFromPointer(t.clientX, t.clientY); }, {passive:true});
  arena.addEventListener('touchmove', (e)=>{ const t=e.touches[0]; if(t) fleeFromPointer(t.clientX, t.clientY); }, {passive:true});

  yesBtn.addEventListener('mouseenter', ()=>yesEscapes());

  noBtn.addEventListener('click', ()=>{
    badge.textContent = "Status: NO was pressed (this will be investigated) üïµÔ∏è‚Äç‚ôÇÔ∏è";
    modalNo.classList.add('show');
  });

  forgotBtn.addEventListener('click', ()=>{
    badge.textContent = "Status: self-roast accepted. Reward incoming‚Ä¶ üç´";
    modalForgot.classList.add('show');
  });

  closeNo.addEventListener('click', ()=>modalNo.classList.remove('show'));
  retryNo.addEventListener('click', ()=>{
    modalNo.classList.remove('show');
    badge.textContent = "Status: wise choice. Try again üòåüíò";
    yesEscapes();
  });

  closeForgot.addEventListener('click', ()=>modalForgot.classList.remove('show'));

  // Power-up flow
  function startPowerUp(){
    modalForgot.classList.remove('show');
    powerOverlay.classList.add('show');

    let t = 3;
    powerCountdown.textContent = `Rewriting the universe in: ${t}‚Ä¶`;
    const timer = setInterval(()=>{
      t--;
      if (t > 0){
        powerCountdown.textContent = `Rewriting the universe in: ${t}‚Ä¶`;
      } else {
        clearInterval(timer);
        powerCountdown.textContent = "Universe updated. YES is now catchable. ‚úÖ";
        setTimeout(()=>{
          powerOverlay.classList.remove('show');
          applyPoweredUpState();
        }, 650);
      }
    }, 700);
  }

  function applyPoweredUpState(){
    poweredUp = true;
    cardRoot.classList.add('powered');

    // Make NO tiny + move it away
    noBtn.style.transform = "scale(0.75)";
    noBtn.style.left = "10%";
    noBtn.style.top  = "75%";
    noBtn.textContent = "NO (weak)";

    // Make YES big, centered, and stop moving
    yesBtn.style.left = "50%";
    yesBtn.style.top  = "44%";
    yesBtn.style.transform = "translate(-50%, -50%) scale(1.35)";
    yesBtn.style.boxShadow = "0 18px 50px rgba(255,45,85,.35)";
    yesBtn.textContent = "YES (click me üòåüíñ)";

    hintText.textContent = "You are now powered up. The YES button can no longer run away. üòàüç´";
    badge.textContent = "Status: SHINY_CHOCOLATE applied. YES unlocked. ‚úÖ";
  }

  chocoBtn.addEventListener('click', startPowerUp);

  // Agreement modal logic
  function openTerms(){
    // reset checkbox/button each time
    termsCheck.checked = false;
    termsAgree.disabled = true;
    modalTerms.classList.add('show');
    spawnConfetti();
  }

  termsCheck.addEventListener('change', ()=>{
    termsAgree.disabled = !termsCheck.checked;
  });

  termsBack.addEventListener('click', ()=>{
    modalTerms.classList.remove('show');
    badge.textContent = "Status: Agreement postponed. Valentine still pending. üòá";
  });

  termsAgree.addEventListener('click', ()=>{
    modalTerms.classList.remove('show');
    modalFinal.classList.add('show');
    badge.textContent = "Status: Agreement signed. Valentine protocol complete. üíò";
  });

  finalClose.addEventListener('click', ()=>{
    modalFinal.classList.remove('show');
  });

  function spawnConfetti(){
    confetti.innerHTML = "";
    const bits = ["üíñ","‚ú®","üíò","üéâ","üíû","üç´"];
    const count = 24;
    for (let i=0; i<count; i++){
      const s = document.createElement("span");
      s.textContent = bits[Math.floor(Math.random()*bits.length)];
      const left = Math.random()*100;
      const dur = 1.8 + Math.random()*1.4;
      const spin = (Math.random()*360 - 180).toFixed(0) + "deg";
      s.style.left = left + "%";
      s.style.animationDuration = dur + "s";
      s.style.setProperty("--spin", spin);
      s.style.fontSize = (14 + Math.random()*14).toFixed(0) + "px";
      s.style.opacity = (0.7 + Math.random()*0.3).toFixed(2);
      confetti.appendChild(s);
      setTimeout(()=>s.remove(), dur*1000);
    }
  }

  // YES click behavior:
  // - before power-up: possible ninja win -> show Terms anyway (funny)
  // - after power-up: show Terms modal as "final setup"
  yesBtn.addEventListener('click', ()=>{
    openTerms();
  });

  // Initial placement (without growing NO)
  placeYesRandomly();

  // Secret override key
  window.addEventListener('keydown', (e)=>{
    if (e.key.toLowerCase() === 'y') {
      applyPoweredUpState();
      alert("Secret override: SHINY_CHOCOLATE applied üç´‚ú®");
    }
  });
</script>
</body>
</html>