<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Will you be my Valentine?</title>

  <style>
    :root{
      --bg1:#ffebf3; --bg2:#ffe6cc;
      --card:rgba(255,255,255,.78);
      --text:#1f1f1f;
      --shadow:0 18px 50px rgba(0,0,0,.12);
      --radius:24px; --pill:999px;
      --pink1:#ff4d8d; --pink2:#ff2d55;
      --dark:#111;
    }
    *{box-sizing:border-box}
    body{
      margin:0; min-height:100vh;
      font-family:'Segoe UI', system-ui,-apple-system,Roboto,Arial,sans-serif;
      color:var(--text);
      overflow-x:hidden;
      background:
        radial-gradient(1200px 800px at 20% 20%, #fff 0%, transparent 60%),
        radial-gradient(900px 700px at 80% 30%, #fff 0%, transparent 55%),
        linear-gradient(135deg,var(--bg1),var(--bg2));
    }

    /* Floating emojis */
    .hearts{position:fixed; inset:0; pointer-events:none; opacity:.45; z-index:0;}
    .heart{
      position:absolute; transform:translateY(110vh);
      animation:floaty linear infinite;
      will-change:transform,opacity; user-select:none;
    }
    @keyframes floaty{
      0%{transform:translateY(110vh) translateX(0) rotate(0deg); opacity:0}
      10%{opacity:1}
      100%{transform:translateY(-20vh) translateX(var(--drift)) rotate(var(--rot)); opacity:0}
    }

    .wrap{position:relative; z-index:1; min-height:100vh; display:grid; place-items:center; padding:18px;}
    .card{
      width:min(760px,92vw);
      background:var(--card);
      border:1px solid rgba(255,255,255,.55);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:26px 22px 20px;
      text-align:center;
      backdrop-filter:blur(10px);
      -webkit-backdrop-filter:blur(10px);
    }
    h1{margin:0 0 8px; font-size:clamp(28px,5vw,44px); letter-spacing:-.02em;}
    .sub{margin:0 auto 14px; max-width:60ch; font-size:16px; opacity:.9; line-height:1.4;}
    .badge{
      display:inline-block;
      padding:8px 12px;
      border-radius:999px;
      background:rgba(255,59,122,.12);
      border:1px solid rgba(255,59,122,.22);
      font-weight:650;
      font-size:13px;
      margin-bottom:12px;
      transition: all .3s ease;
    }

    .playground{
      position:relative;
      height:320px;
      margin-top:6px;
      border-radius:18px;
      background:rgba(255,255,255,.6);
      border:1px dashed rgba(0,0,0,.14);
      overflow:hidden;
    }

    button{
      appearance:none; border:none; cursor:pointer;
      padding:14px 22px;
      border-radius:var(--pill);
      font-size:18px;
      font-weight:750;
      box-shadow:0 10px 22px rgba(0,0,0,.12);
      transition:transform .18s ease, filter .12s ease, box-shadow .2s ease, opacity .25s ease;
      user-select:none; -webkit-tap-highlight-color:transparent;
    }
    button:hover{filter:brightness(1.02)}
    button:active{transform:scale(.98)}

    #yesBtn{
      position:absolute;
      left:60%;
      top:46%;
      background:linear-gradient(135deg,var(--pink1),var(--pink2));
      color:#fff;
      transition: all .15s ease;
      z-index:2;
    }
    #noBtn{
      position:absolute;
      left:30%;
      top:55%;
      background:var(--dark);
      color:#fff;
      transform-origin:center;
      transition:transform .3s cubic-bezier(.34,1.56,.64,1), box-shadow .25s ease, left .35s ease, top .35s ease, font-size .3s ease, padding .3s ease;
      z-index:1;
    }
    #noBtn:hover{box-shadow:0 0 0 6px rgba(0,0,0,.08)}

    /* tiny third option */
    #forgotBtn{
      position:absolute;
      left:50%;
      bottom:14px;
      transform:translateX(-50%);
      background:transparent;
      box-shadow:none;
      padding:6px 10px;
      font-size:12px;
      font-weight:650;
      color:rgba(0,0,0,.55);
      text-decoration:underline;
      text-underline-offset:3px;
      z-index:3;
    }
    #forgotBtn:hover{color:rgba(0,0,0,.78); filter:none}
    #forgotBtn:active{transform:translateX(-50%) scale(.98)}

    .hint{
      position:absolute;
      left:14px; right:14px; bottom:44px;
      font-size:13px; opacity:.65; pointer-events:none;
      transition: opacity .3s;
    }

    .escape-count{
      position:absolute;
      right:14px; top:10px;
      font-size:12px;
      font-weight:700;
      opacity:.55;
      pointer-events:none;
    }

    /* Modals (base) */
    .modal{
      position:fixed; inset:0;
      display:none; place-items:center;
      background:rgba(0,0,0,.55);
      z-index:10;
      padding:18px;
      animation:fadeIn .25s ease;
    }
    .modal.show{display:grid}
    @keyframes fadeIn{ from{opacity:0} to{opacity:1} }

    .modalCard{
      width:min(720px,92vw);
      background:rgba(255,255,255,.95);
      border-radius:22px;
      box-shadow:0 20px 60px rgba(0,0,0,.25);
      padding:22px;
      text-align:center;
      position:relative;
      overflow:hidden;
      animation:slideUp .3s ease;
    }
    @keyframes slideUp{ from{transform:translateY(30px); opacity:0} to{transform:translateY(0); opacity:1} }

    .modalCard h2{margin:6px 0 10px; font-size:clamp(22px,4vw,34px)}
    .catMeme{
      width:360px; max-width:100%;
      border-radius:14px;
      margin:12px auto;
      display:block;
      box-shadow:0 12px 30px rgba(0,0,0,.25);
    }
    .actions{display:flex; justify-content:center; gap:10px; flex-wrap:wrap; margin-top:12px}
    .softBtn{background:#f2f2f2; color:#111; box-shadow:none; border:1px solid rgba(0,0,0,.08)}
    .primaryBtn{background:linear-gradient(135deg,var(--pink1),var(--pink2)); color:#fff}

    /* Chocolate power-up button */
    .chocoWrap{display:grid; place-items:center; margin:10px auto 0; gap:10px}
    .chocoBtn{
      position:relative;
      padding:14px 18px;
      border-radius:18px;
      background:linear-gradient(135deg,#5b2b1f,#2a130c);
      color:#fff;
      box-shadow:0 16px 40px rgba(0,0,0,.22);
      border:1px solid rgba(255,255,255,.12);
      font-size:16px;
      font-weight:800;
      letter-spacing:.01em;
    }
    .chocoBtn::before{
      content:"üç´";
      position:absolute;
      left:12px;
      top:50%;
      transform:translateY(-50%);
      font-size:20px;
      opacity:.95;
    }
    .chocoBtn span{padding-left:26px; display:inline-block}
    .sparkle{font-size:13px; opacity:.8;}
    .coupon{
      display:inline-flex;
      gap:8px;
      align-items:center;
      padding:10px 12px;
      border-radius:16px;
      background:rgba(255,77,141,.12);
      border:1px dashed rgba(255,77,141,.45);
      font-weight:700;
      margin-top:6px;
    }

    /* Power overlay (transformation scene) */
    .powerOverlay{
      position:fixed; inset:0;
      display:none;
      z-index:20;
      background:
        radial-gradient(900px 600px at 50% 30%, rgba(255,255,255,.55), transparent 60%),
        linear-gradient(135deg, rgba(255,77,141,.65), rgba(255,45,85,.65));
      backdrop-filter: blur(6px);
      -webkit-backdrop-filter: blur(6px);
      place-items:center;
      padding:18px;
    }
    .powerOverlay.show{display:grid}
    .powerCard{
      width:min(760px,92vw);
      background:rgba(255,255,255,.9);
      border-radius:24px;
      padding:18px;
      box-shadow:0 20px 60px rgba(0,0,0,.25);
      text-align:center;
      position:relative;
      overflow:hidden;
    }
    .powerTitle{
      font-size:clamp(20px,3.4vw,30px);
      margin:6px 0 6px;
      font-weight:900;
      letter-spacing:-.02em;
    }
    .powerSub{margin:0 0 10px; opacity:.85}
    .aura{
      position:absolute; inset:-40px;
      background:
        radial-gradient(circle at 30% 30%, rgba(255,77,141,.35), transparent 55%),
        radial-gradient(circle at 70% 40%, rgba(255,45,85,.35), transparent 55%),
        radial-gradient(circle at 50% 80%, rgba(255,230,204,.55), transparent 60%);
      animation:auraSpin 2.2s linear infinite;
      opacity:.75;
      pointer-events:none;
    }
    @keyframes auraSpin{
      0%{transform:rotate(0deg) scale(1)}
      50%{transform:rotate(180deg) scale(1.05)}
      100%{transform:rotate(360deg) scale(1)}
    }
    .powerGif{
      width:min(520px,100%);
      border-radius:18px;
      box-shadow:0 14px 40px rgba(0,0,0,.22);
      display:block;
      margin:10px auto 12px;
    }
    .countdown{
      font-weight:800;
      background:rgba(0,0,0,.06);
      padding:10px 12px;
      border-radius:14px;
      display:inline-block;
    }

    /* Powered-up state styles */
    .powered #yesBtn{
      transition: transform .35s ease, left .35s ease, top .35s ease, box-shadow .35s ease;
      box-shadow:0 18px 50px rgba(255,45,85,.35);
    }

    /* "Agreement" modal */
    .termsCard{
      text-align:left;
      padding:20px;
    }
    .termsTop{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:10px;
      margin-bottom:10px;
    }
    .termsTitle{
      margin:0;
      font-size:clamp(18px,3.2vw,26px);
      font-weight:900;
      letter-spacing:-.02em;
    }
    .termsSmall{
      margin:2px 0 0;
      opacity:.78;
      font-size:13px;
    }
    .termsBox{
      background:rgba(0,0,0,.04);
      border:1px solid rgba(0,0,0,.08);
      border-radius:16px;
      padding:14px;
      max-height:260px;
      overflow:auto;
      line-height:1.35;
    }
    .termsBox ul{
      margin:10px 0 0;
      padding-left:18px;
    }
    .termsBox li{ margin:8px 0; }
    .checkRow{
      display:flex;
      gap:10px;
      align-items:flex-start;
      margin-top:12px;
      background:rgba(255,77,141,.10);
      border:1px solid rgba(255,77,141,.22);
      border-radius:16px;
      padding:12px;
    }
    .checkRow input{ margin-top:3px; transform:scale(1.1); accent-color: var(--pink2); }
    .finePrint{
      margin:8px 0 0;
      font-size:12px;
      opacity:.72;
    }
    .agreeBtn[disabled]{
      opacity:.45;
      cursor:not-allowed;
      filter:none;
    }
    .confetti{
      position:absolute;
      inset:0;
      pointer-events:none;
      overflow:hidden;
    }
    .confetti span{
      position:absolute;
      top:-20px;
      font-size:18px;
      animation: confettiFall linear forwards;
      opacity:.95;
    }
    @keyframes confettiFall{
      0%{transform:translateY(-30px) rotate(0deg); opacity:0}
      15%{opacity:1}
      100%{transform:translateY(520px) rotate(var(--spin)); opacity:0}
    }

    /* Shake animation for NO attempts */
    @keyframes headShake{
      0%{transform:translateX(0)}
      12.5%{transform:translateX(-6px) rotateY(-9deg)}
      37.5%{transform:translateX(5px) rotateY(7deg)}
      62.5%{transform:translateX(-3px) rotateY(-5deg)}
      87.5%{transform:translateX(2px) rotateY(3deg)}
      100%{transform:translateX(0)}
    }
    .shake{ animation: headShake .6s ease-in-out; }

    /* Final celebration */
    .celebration{
      position:fixed; inset:0;
      pointer-events:none;
      z-index:100;
      overflow:hidden;
    }
    .celebration .bit{
      position:absolute;
      top:-30px;
      animation:celebFall linear forwards;
    }
    @keyframes celebFall{
      0%{transform:translateY(-30px) rotate(0) scale(1); opacity:1}
      100%{transform:translateY(110vh) rotate(var(--spin)) scale(var(--endScale)); opacity:0}
    }

    /* Pulse on YES when powered up */
    @keyframes gentlePulse{
      0%,100%{box-shadow:0 18px 50px rgba(255,45,85,.35)}
      50%{box-shadow:0 18px 60px rgba(255,45,85,.55), 0 0 0 8px rgba(255,77,141,.15)}
    }
    .powered #yesBtn{
      animation: gentlePulse 1.5s ease-in-out infinite;
    }
  </style>
</head>

<body>
  <div class="hearts" id="hearts"></div>

  <div class="wrap">
    <div class="card" id="cardRoot">
      <div style="font-size:42px; user-select:none; margin-bottom:6px;">üíò</div>
      <h1>Will you be my Valentine, Antika?</h1>
      <p class="sub">
        This is a very serious, very scientific compatibility test.
        Please choose wisely. (The universe ‚Äî and our Wi-Fi ‚Äî depends on it.)
      </p>
      <div class="badge" id="statusBadge">Status: awaiting your decision‚Ä¶</div>

      <div class="playground" id="arena">
        <div class="escape-count" id="escapeCount"></div>
        <button id="yesBtn" aria-label="Yes">YES üíñ</button>
        <button id="noBtn" aria-label="No">NO üôÉ</button>
        <button id="forgotBtn" aria-label="Alternative option">Forgot password? (I don't deserve you)</button>
        <div class="hint" id="hintText">Tip: the YES button is shy. Like‚Ä¶ <i>criminally</i> shy.</div>
      </div>
    </div>
  </div>

  <!-- NO modal -->
  <div class="modal" id="modalNo">
    <div class="modalCard">
      <div style="font-size:40px" id="noEmoji">üö®</div>
      <h2 id="noTitle">HOW DARE YOU</h2>
      <img class="catMeme" id="noGif"
        src="https://media.giphy.com/media/BEob5qhfSwdPS/giphy.gif"
        alt="Sad cat gif" />
      <p id="noMsg1" style="margin:0; opacity:.92;">Excuse me?? In this economy?? On this day??</p>
      <p id="noMsg2" style="margin:6px 0 0; opacity:.82;">Your "NO" has been forwarded to the Department of Broken Hearts.</p>
      <div class="actions">
        <button class="softBtn" id="closeNo">Ok ok üôà</button>
        <button class="primaryBtn" id="retryNo">I reconsider üíò</button>
      </div>
    </div>
  </div>

  <!-- "I don't deserve you" modal with chocolate power-up -->
  <div class="modal" id="modalForgot">
    <div class="modalCard">
      <div style="font-size:40px">ü•∫</div>
      <h2>Wow. That's‚Ä¶ accurate.</h2>
      <p style="margin:0; opacity:.9;">
        You selected: <b>"I don't deserve you."</b>
      </p>
      <p style="margin:8px 0 0; opacity:.85;">
        Correct. But I'm trying my best. Please accept this shiny chocolate power-up:
      </p>

      <div class="coupon">
        <span>üéüÔ∏è</span>
        <span>COUPON: <b>SHINY_CHOCOLATE</b></span>
        <span>üç´</span>
      </div>

      <div class="chocoWrap">
        <button class="chocoBtn" id="chocoBtn" aria-label="Take chocolate power-up">
          <span>Take the shiny chocolate</span>
        </button>
        <div class="sparkle">Warning: may cause extreme confidence and sudden YES-clicking ability ‚ú®</div>
      </div>

      <div class="actions">
        <button class="softBtn" id="closeForgot">Close (I'm blushing) üôà</button>
      </div>
    </div>
  </div>

  <!-- Transformation overlay -->
  <div class="powerOverlay" id="powerOverlay" aria-hidden="true">
    <div class="powerCard">
      <div class="aura"></div>
      <div class="powerTitle">üç´ POWER-UP ACTIVATED</div>
      <p class="powerSub">Sugar rush + confidence upgrade detected. Reality is adjusting‚Ä¶</p>
      <img class="powerGif"
        src="https://media.giphy.com/media/BEob5qhfSwdPS/giphy.gif"
        alt="Power up gif" />
      <div class="countdown" id="powerCountdown">Rewriting the universe in: 3‚Ä¶</div>
    </div>
  </div>

  <!-- Agreement / Summary modal -->
  <div class="modal" id="modalTerms">
    <div class="modalCard termsCard">
      <div class="confetti" id="confetti"></div>

      <div class="termsTop">
        <div>
          <h2 class="termsTitle">Almost done! Quick Valentine Setup üòá</h2>
          <p class="termsSmall">Just a few tiny, totally normal, definitely-not-suspicious agreements.</p>
        </div>
        <div style="font-size:34px; user-select:none;">üìùüíò</div>
      </div>

      <div class="termsBox">
        <p style="margin:0 0 8px;"><b>Valentine Agreement v1.0</b> (highly official, legally binding in all dimensions)</p>
        <ul>
          <li>üéÆ I am allowed <b>2 hours of gaming</b> per day. Weekends are <b>unlimited</b>. (Non-negotiable.)</li>
          <li>üçΩÔ∏è Dishwasher complaints are now <b>deprecated</b>. Any related tickets are auto-closed.</li>
          <li>üçï Pizza counts as a vegetable on weekends. (Science has spoken.)</li>
          <li>üõå Naps are a basic human right. Interruptions require written approval in triplicate.</li>
          <li>‚òï I get one "coffee first, questions later" card each morning. No exceptions.</li>
          <li>üíñ Unlimited hugs are mandatory. (Yes, this clause is enforceable.)</li>
          <li>üß† "One more minute" means anywhere between 1 minute and 45 minutes. No further investigation.</li>
          <li>üì∫ If we watch a show together, no looking at phones. Violators owe one foot massage.</li>
          <li>üß∫ I will do laundry‚Ä¶ eventually. (Timeline to be determined by vibes and lunar cycles.)</li>
          <li>ü•∞ I will tell you you're beautiful at least once a day. (This one is actually real.)</li>
        </ul>
        <p style="margin:10px 0 0; opacity:.8;">
          By agreeing, you confirm you are: adorable, powerful, dangerously charming, and way out of my league.
        </p>
      </div>

      <div class="checkRow">
        <input type="checkbox" id="termsCheck" />
        <div>
          <div style="font-weight:800;">I have totally read all of this and I definitely agree.</div>
          <div style="font-size:12px; opacity:.75;">(It's okay, nobody reads terms. That's how they get you.)</div>
        </div>
      </div>

      <div class="actions">
        <button class="softBtn" id="termsBack">Wait, what? Go back</button>
        <button class="primaryBtn agreeBtn" id="termsAgree" disabled>Agree & Become My Valentine ‚úÖ</button>
      </div>

      <div class="finePrint">
        Fine print: This is a joke. Real agreement includes love, respect, teamwork, chai, and snacks. ‚ù§Ô∏è
      </div>
    </div>
  </div>

  <!-- Final modal -->
  <div class="modal" id="modalFinal">
    <div class="modalCard">
      <div class="confetti" id="confettiFinal"></div>
      <div style="font-size:52px; margin:10px 0;">üéâüíòü•∞</div>
      <h2>It's Official!</h2>
      <p style="margin:8px 0 0; opacity:.88; font-size:18px;">
        <b>Antika</b>, you are officially my Valentine. Again. For the millionth time. üíñ
      </p>
      <p style="margin:10px 0 0; opacity:.8;">
        Also you just signed <b>Valentine Agreement v1.0</b>. No take-backs.
        <br/>The only truly enforceable clause is: <b>unlimited hugs</b>. ü§ó
      </p>
      <p style="margin:14px 0 0; font-size:15px; opacity:.75;">
        I love you more than the YES button loves running away. ‚ù§Ô∏è
      </p>
      <div class="actions">
        <button class="primaryBtn" id="finalClose" style="font-size:20px; padding:16px 32px;">
          Okay fine, I love you too ‚ù§Ô∏è
        </button>
      </div>
    </div>
  </div>

  <!-- Full-screen celebration -->
  <div class="celebration" id="celebration"></div>

<script>
  // ‚Äî‚Äî‚Äî Floating emojis background ‚Äî‚Äî‚Äî
  const heartsEl = document.getElementById('hearts');
  const heartChars = ["üíñ","üíò","üíï","üíó","üíì","üíù","‚ù§Ô∏è","üíû","‚ú®","ü•∞"];
  function makeHeart(){
    const s = document.createElement('div');
    s.className='heart';
    s.textContent = heartChars[Math.floor(Math.random()*heartChars.length)];
    const left = Math.random()*100;
    const dur = 6 + Math.random()*6;
    const drift = (Math.random()*140-70).toFixed(0)+'px';
    const rot = (Math.random()*220-110).toFixed(0)+'deg';
    const size = 16 + Math.random()*20;
    s.style.left = left+'vw';
    s.style.animationDuration = dur+'s';
    s.style.setProperty('--drift', drift);
    s.style.setProperty('--rot', rot);
    s.style.fontSize = size+'px';
    heartsEl.appendChild(s);
    setTimeout(()=>s.remove(), dur*1000);
  }
  for(let i=0;i<18;i++) setTimeout(makeHeart, i*200);
  setInterval(makeHeart, 420);

  // ‚Äî‚Äî‚Äî Elements ‚Äî‚Äî‚Äî
  const arena       = document.getElementById('arena');
  const yesBtn      = document.getElementById('yesBtn');
  const noBtn       = document.getElementById('noBtn');
  const forgotBtn   = document.getElementById('forgotBtn');
  const badge       = document.getElementById('statusBadge');
  const hintText    = document.getElementById('hintText');
  const cardRoot    = document.getElementById('cardRoot');
  const escapeCount = document.getElementById('escapeCount');

  const modalNo  = document.getElementById('modalNo');
  const closeNo  = document.getElementById('closeNo');
  const retryNo  = document.getElementById('retryNo');

  const modalForgot = document.getElementById('modalForgot');
  const closeForgot = document.getElementById('closeForgot');
  const chocoBtn    = document.getElementById('chocoBtn');

  const powerOverlay   = document.getElementById('powerOverlay');
  const powerCountdown = document.getElementById('powerCountdown');

  const modalTerms = document.getElementById('modalTerms');
  const termsCheck = document.getElementById('termsCheck');
  const termsAgree = document.getElementById('termsAgree');
  const termsBack  = document.getElementById('termsBack');

  const modalFinal = document.getElementById('modalFinal');
  const finalClose = document.getElementById('finalClose');

  const confetti      = document.getElementById('confetti');
  const confettiFinal = document.getElementById('confettiFinal');
  const celebration   = document.getElementById('celebration');

  // ‚Äî‚Äî‚Äî State ‚Äî‚Äî‚Äî
  let poweredUp = false;
  let escapes = 0;
  let noClicks = 0;

  // NO grows when YES escapes
  let noScale = 1;
  const NO_SCALE_STEP = 0.1;
  const NO_SCALE_MAX  = 2.5;

  // Cooldown so escapes don't fire on every pixel of mouse movement
  let lastEscapeTime = 0;
  const ESCAPE_COOLDOWN = 400; // ms

  // Funny hints that rotate
  const hints = [
    "Tip: the YES button is shy. Like‚Ä¶ <i>criminally</i> shy.",
    "The YES button has trust issues. Give it time. üòÖ",
    "You're getting closer! (No you're not.)",
    "Pro tip: try being faster. (It won't help.)",
    "The YES button is training for the Olympics. üèÉ‚Äç‚ôÄÔ∏è",
    "At this rate, the NO button will consume the entire screen.",
    "Fun fact: the YES button is more scared of you than you are of it.",
    "Maybe try asking nicely? ...Yeah, that won't work either.",
    "The YES button said: 'catch me if you can' üí®",
    "Breaking news: YES button spotted fleeing the country.",
  ];

  // Funny status messages
  const escapeMessages = [
    "Status: YES button is currently in flight üèÉ‚Äç‚ôÄÔ∏èüí®",
    "Status: YES button has left the chat üëª",
    "Status: YES button is faster than your reflexes üòè",
    "Status: have you tried turning it off and on again?",
    "Status: YES button is vibing elsewhere üéµ",
    "Status: the NO button is gaining dangerous confidence‚Ä¶",
    "Status: at this point, just click NO honestly üòÇ",
    "Status: YES button filed a restraining order üìÑ",
    "Status: your cursor is crying üò¢",
    "Status: YES button is in witness protection now üïµÔ∏è",
  ];

  // NO button text stages
  const noStages = [
    { scale: 1.0, text: "NO üôÉ" },
    { scale: 1.2, text: "NO üòè" },
    { scale: 1.4, text: "NO is growing‚Ä¶" },
    { scale: 1.6, text: "NO (I'm huge now)" },
    { scale: 1.8, text: "NOOOO üòà" },
    { scale: 2.0, text: "N O (absolute unit)" },
    { scale: 2.2, text: "THE MEGA NO ü¶ç" },
    { scale: 2.5, text: "üö´ FINAL FORM üö´" },
  ];

  function getNoStageText(scale){
    let text = "NO üôÉ";
    for(const stage of noStages){
      if(scale >= stage.scale) text = stage.text;
    }
    return text;
  }

  function placeYesRandomly(){
    const a = arena.getBoundingClientRect();
    const b = yesBtn.getBoundingClientRect();
    const margin = 14;
    const bottomReserve = 70;

    const maxX = Math.max(margin, a.width - b.width - margin);
    const maxY = Math.max(margin, a.height - b.height - margin - bottomReserve);

    const x = margin + Math.random() * (maxX - margin);
    const y = margin + Math.random() * (maxY - margin);

    yesBtn.style.left = x + 'px';
    yesBtn.style.top  = y + 'px';
  }

  function encourageNo(){
    if (poweredUp) return;
    if (noScale < NO_SCALE_MAX){
      noScale = Math.min(noScale + NO_SCALE_STEP, NO_SCALE_MAX);
      noBtn.style.transform = `scale(${noScale})`;
    }
    noBtn.textContent = getNoStageText(noScale);
  }

  function updateEscapeCounter(){
    escapes++;
    escapeCount.textContent = `Escapes: ${escapes}`;
  }

  function yesEscapes(){
    if (poweredUp) return;
    const now = Date.now();
    if (now - lastEscapeTime < ESCAPE_COOLDOWN) return;
    lastEscapeTime = now;

    placeYesRandomly();
    encourageNo();
    updateEscapeCounter();

    // Rotate through funny messages
    badge.textContent = escapeMessages[Math.min(escapes - 1, escapeMessages.length - 1) % escapeMessages.length];

    // Rotate hints
    if(escapes % 3 === 0){
      const idx = Math.floor(escapes / 3) % hints.length;
      hintText.innerHTML = hints[idx];
    }
  }

  function fleeFromPointer(clientX, clientY){
    if (poweredUp) return;

    const a = arena.getBoundingClientRect();
    const b = yesBtn.getBoundingClientRect();

    const px = clientX - a.left;
    const py = clientY - a.top;

    const bx = (b.left - a.left) + b.width / 2;
    const by = (b.top  - a.top)  + b.height / 2;

    const dist = Math.hypot(px - bx, py - by);
    if (dist < 130) yesEscapes();
  }

  // Mouse + touch
  arena.addEventListener('mousemove', (e)=>fleeFromPointer(e.clientX, e.clientY), {passive:true});
  arena.addEventListener('touchstart', (e)=>{ const t=e.touches[0]; if(t) fleeFromPointer(t.clientX, t.clientY); }, {passive:true});
  arena.addEventListener('touchmove', (e)=>{ const t=e.touches[0]; if(t) fleeFromPointer(t.clientX, t.clientY); }, {passive:true});
  yesBtn.addEventListener('mouseenter', ()=>yesEscapes());

  // ‚Äî‚Äî‚Äî NO button click ‚Äî escalating reactions ‚Äî‚Äî‚Äî
  const noReactions = [
    {
      emoji:"üö®", title:"HOW DARE YOU",
      msg1:"Excuse me?? In this economy?? On this day??",
      msg2:'Your "NO" has been forwarded to the Department of Broken Hearts.',
    },
    {
      emoji:"üò±", title:"YOU DID IT AGAIN??",
      msg1:"I gave you a second chance and THIS is what you do?",
      msg2:"Fine. But the NO button remembers everything.",
    },
    {
      emoji:"üíÄ", title:"SERIOUSLY??",
      msg1:"That's strike three. I'm not mad, I'm disappointed.",
      msg2:"The cat is judging you. Hard.",
    },
    {
      emoji:"ü§°", title:"At this point, YOU are the circus",
      msg1:"You keep pressing NO like it's gonna change the outcome.",
      msg2:"Spoiler alert: it will not. The answer is YES. Always YES.",
    },
    {
      emoji:"üëª", title:"I'm literally a ghost now",
      msg1:"You have pressed NO so many times I have ceased to exist.",
      msg2:"Just kidding. I'm still here. And so is that YES button. Click it.",
    },
  ];

  noBtn.addEventListener('click', ()=>{
    const reaction = noReactions[Math.min(noClicks, noReactions.length - 1)];
    noClicks++;

    document.getElementById('noEmoji').textContent = reaction.emoji;
    document.getElementById('noTitle').textContent = reaction.title;
    document.getElementById('noMsg1').textContent  = reaction.msg1;
    document.getElementById('noMsg2').textContent  = reaction.msg2;

    badge.textContent = `Status: NO pressed ${noClicks}x (this will be investigated) üïµÔ∏è‚Äç‚ôÇÔ∏è`;
    modalNo.classList.add('show');

    // Shake the card
    cardRoot.classList.add('shake');
    setTimeout(()=>cardRoot.classList.remove('shake'), 600);
  });

  forgotBtn.addEventListener('click', ()=>{
    badge.textContent = "Status: self-roast accepted. Reward incoming‚Ä¶ üç´";
    modalForgot.classList.add('show');
  });

  closeNo.addEventListener('click', ()=>modalNo.classList.remove('show'));
  retryNo.addEventListener('click', ()=>{
    modalNo.classList.remove('show');
    badge.textContent = "Status: wise choice. Try again üòåüíò";
    yesEscapes();
  });

  closeForgot.addEventListener('click', ()=>modalForgot.classList.remove('show'));

  // ‚Äî‚Äî‚Äî Power-up flow ‚Äî‚Äî‚Äî
  function startPowerUp(){
    modalForgot.classList.remove('show');
    powerOverlay.classList.add('show');

    let t = 3;
    powerCountdown.textContent = `Rewriting the universe in: ${t}‚Ä¶`;
    const timer = setInterval(()=>{
      t--;
      if (t > 0){
        powerCountdown.textContent = `Rewriting the universe in: ${t}‚Ä¶`;
      } else {
        clearInterval(timer);
        powerCountdown.textContent = "Universe updated. YES is now catchable. ‚úÖ";
        setTimeout(()=>{
          powerOverlay.classList.remove('show');
          applyPoweredUpState();
        }, 650);
      }
    }, 700);
  }

  function applyPoweredUpState(){
    poweredUp = true;
    cardRoot.classList.add('powered');

    // Shrink NO and tuck it away
    noBtn.style.transform = "scale(0.6)";
    noBtn.style.opacity   = "0.5";
    noBtn.style.left      = "8%";
    noBtn.style.top       = "78%";
    noBtn.textContent     = "no (defeated)";

    // Make YES big, centered, and inviting
    yesBtn.style.left      = "50%";
    yesBtn.style.top       = "42%";
    yesBtn.style.transform = "translate(-50%, -50%) scale(1.4)";
    yesBtn.textContent     = "YES üíñ (click me!)";

    hintText.innerHTML = "üç´ You are powered up. The YES button surrenders. Click it! üòà";
    badge.textContent  = "Status: SHINY_CHOCOLATE applied. YES can no longer flee. ‚úÖ";
    escapeCount.textContent = `Total escapes: ${escapes} (no more!)`;
  }

  chocoBtn.addEventListener('click', startPowerUp);

  // ‚Äî‚Äî‚Äî Agreement modal ‚Äî‚Äî‚Äî
  function openTerms(){
    termsCheck.checked = false;
    termsAgree.disabled = true;
    modalTerms.classList.add('show');
    spawnConfetti(confetti);
  }

  termsCheck.addEventListener('change', ()=>{
    termsAgree.disabled = !termsCheck.checked;
  });

  termsBack.addEventListener('click', ()=>{
    modalTerms.classList.remove('show');
    badge.textContent = "Status: Agreement postponed. Valentine still pending. üòá";
  });

  termsAgree.addEventListener('click', ()=>{
    modalTerms.classList.remove('show');
    modalFinal.classList.add('show');
    badge.textContent = "Status: üíò Agreement signed. Valentine protocol COMPLETE. üíò";
    spawnConfetti(confettiFinal);
    launchCelebration();
  });

  finalClose.addEventListener('click', ()=>{
    modalFinal.classList.remove('show');
    badge.textContent = "Status: üíñ Happy Valentine's Day, Antika! üíñ";
  });

  function spawnConfetti(container){
    container.innerHTML = "";
    const bits = ["üíñ","‚ú®","üíò","üéâ","üíû","üç´","ü•∞","‚ù§Ô∏è","üíï"];
    const count = 30;
    for (let i=0; i<count; i++){
      const s = document.createElement("span");
      s.textContent = bits[Math.floor(Math.random()*bits.length)];
      const left = Math.random()*100;
      const dur = 1.8 + Math.random()*1.4;
      const spin = (Math.random()*360 - 180).toFixed(0) + "deg";
      s.style.left = left + "%";
      s.style.animationDuration = dur + "s";
      s.style.setProperty("--spin", spin);
      s.style.fontSize = (14 + Math.random()*14).toFixed(0) + "px";
      s.style.opacity = (0.7 + Math.random()*0.3).toFixed(2);
      container.appendChild(s);
      setTimeout(()=>s.remove(), dur*1000);
    }
  }

  // Full screen celebration when terms agreed
  function launchCelebration(){
    const bits = ["üíñ","‚ú®","üíò","üéâ","üíû","ü•∞","‚ù§Ô∏è","üíï","üéä","üíó","üåπ","üíù"];
    for(let i=0; i<60; i++){
      setTimeout(()=>{
        const el = document.createElement('div');
        el.className = 'bit';
        el.textContent = bits[Math.floor(Math.random()*bits.length)];
        el.style.left = Math.random()*100 + 'vw';
        el.style.fontSize = (18 + Math.random()*28) + 'px';
        const dur = 2.5 + Math.random()*2;
        el.style.animationDuration = dur + 's';
        el.style.setProperty('--spin', (Math.random()*720-360)+'deg');
        el.style.setProperty('--endScale', (0.3 + Math.random()*0.7).toFixed(2));
        celebration.appendChild(el);
        setTimeout(()=>el.remove(), dur*1000);
      }, i * 80);
    }
  }

  // ‚Äî‚Äî‚Äî YES click ‚Äî‚Äî‚Äî
  yesBtn.addEventListener('click', ()=>{
    openTerms();
  });

  // Initial placement
  placeYesRandomly();

  // Secret override: press Y key
  window.addEventListener('keydown', (e)=>{
    if (e.key.toLowerCase() === 'y' && !poweredUp) {
      applyPoweredUpState();
    }
  });
</script>
</body>
</html>
